<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>fake art</title>
    <style type="text/css">
      body {
        display: flex;
        height: 100vh;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }
      #picture {
        height: 700px;
        width: 500px;
        display: flex;
        flex-wrap: wrap;
      }
    </style>
  </head>
  <body>
    <script>
      let url = "liza.jpeg";
      //       let url = "vanGog.jpg";
    </script>

    <div id="picture"></div>

    <script>
      //
      // нужно при рисовании генерировать работу
      // - картина рисуется в среднем за 5 секунд
      //
      // нужно её сохранять до продажи
      // - генерим рандомы на каждый «пиксель»
      // - сохраняем все рандомы для каждой картины в local storage
      //
      // нужно её воспроизводить в таком же виде если вышли
      // из браузера и зашли обратно (пока она не продана)
      // - берём рандомы из local storage и генерим картину
      //
      // нужно генерировать новые работы, которые нарисовались
      // в оффлайне и ещё не продались
      // - при загрузке считаем сколько картин нужно нагенерить
      // - генерим картины
      // - кладём в local storage
      // - выводим картины
      //
      document.addEventListener("DOMContentLoaded", () => {
        let elem = document.getElementById("picture");
        // elem.style.backgroundImage = "url(" + url + ")";

        const imW = elem.offsetWidth;
        const imH = elem.offsetHeight;

        const count = 10;

        const divW = imW / count;
        const divH = imH / count;

        let i = 0;
        let y = 0;
        let top = 0;
        let left = 0;

        const filters = [
          "normal",
          "blur",
          "saturate",
          "hue-rotate",
          "brightness",
          "contrast",
          "invert",
        ];

        let paintingData = [
          [0.7807481273099313, 0.36517912914494866],
          [0.4118146839602479, 0.2126590024563968],
          [0.026890677396500084, 0.36628585184811957],
          [0.9668863623580157, 0.6846507811063032],
          [0.7375093568368727, 0.6242976842220229],
          [0.8639851800155647, 0.8642831592557099],
          [0.5344503562632057, 0.7621553645233512],
          [0.21073502220632934, 0.08443056207648714],
          [0.2634799941970114, 0.1216786251319415],
          [0.6607794712722463, 0.845225862428155],
          [0.13026098164959166, 0.8302240584482425],
          [0.9015518515902272, 0.7452800928426659],
          [0.26910854731038936, 0.3356850965681806],
          [0.2600419910616929, 0.21296598109178477],
          [0.8834542735655317, 0.25995058852011366],
          [0.9587898654081137, 0.3590807821959998],
          [0.1563195616966988, 0.16359750648831262],
          [0.6765595287252502, 0.4652482214301321],
          [0.8376596031470289, 0.8591154192198582],
          [0.31259517259623704, 0.7924539154460544],
          [0.24533458244340633, 0.8503680441676775],
          [0.6725057714331941, 0.5821710678610394],
          [0.9690037673294851, 0.9816652044389105],
          [0.2493952794586054, 0.7884994807196721],
          [0.837986961249833, 0.8912754037734927],
          [0.13501013081407343, 0.9206629009175546],
          [0.6686085919083955, 0.7277247881674287],
          [0.3043448163885434, 0.6972767436625418],
          [0.37909825071593106, 0.8765290025193198],
          [0.5573383643156531, 0.3397126459727906],
          [0.8349464004380869, 0.40297089721068025],
          [0.4262696354240718, 0.1816591194513757],
          [0.06682386912701599, 0.9254790043631069],
          [0.7350467750131249, 0.3938305620432312],
          [0.15028405121027388, 0.2596751455296611],
          [0.8544542485590267, 0.14125653958534423],
          [0.9611508886325972, 0.3165667667898564],
          [0.6710211098236456, 0.07996307999297536],
          [0.35234926897771723, 0.6859253504427505],
          [0.07690643058432456, 0.5228038104228887],
          [0.35286567183259754, 0.5082653004771807],
          [0.65974336148855, 0.6139430663644587],
          [0.4818122752908054, 0.1442601394903371],
          [0.5292253311733324, 0.37222242209249234],
          [0.9745024597689991, 0.6485954524159794],
          [0.11746016209387244, 0.9137776279650052],
          [0.3427693398030742, 0.8495020154701227],
          [0.7055195841747139, 0.36407902129649017],
          [0.5903690450554546, 0.5038676610769892],
          [0.1449755666581165, 0.07970698994104031],
          [0.7058511403302155, 0.1698351556824862],
          [0.9706539398547507, 0.14532923241987938],
          [0.22152029256800354, 0.47358851355386467],
          [0.005811602321808662, 0.11915211694072969],
          [0.5621903613639785, 0.1232726047273216],
          [0.31058119232882353, 0.9139486225109703],
          [0.5313469387997398, 0.3473929432518439],
          [0.5579859456932392, 0.93735101528139],
          [0.2997110102296163, 0.989690109192261],
          [0.20978635750611208, 0.41202016248025],
          [0.21365027618468613, 0.16322236788108002],
          [0.17351844304815178, 0.7696966830000194],
          [0.9109042884375738, 0.06015862681176909],
          [0.19352970638433042, 0.04221930547529218],
          [0.11401964263313191, 0.9211972949842742],
          [0.09198580749201812, 0.7575936604664719],
          [0.4558784527649915, 0.6671312002228953],
          [0.8576500443522574, 0.695660562867709],
          [0.2458442856871681, 0.3349263487699894],
          [0.08881825112418329, 0.35141063992225674],
          [0.767543857551803, 0.7733260805019979],
          [0.6862240648644191, 0.10864561121857741],
          [0.6852631694953408, 0.7118711483202604],
          [0.09682929590345202, 0.6923277526089837],
          [0.1460818706843976, 0.8486203315671872],
          [0.9542914666649092, 0.7855819335248935],
          [0.7875666566151172, 0.8916422001870756],
          [0.529726346146032, 0.9542691221363844],
          [0.2558093306913618, 0.1720222948347252],
          [0.6533626067538054, 0.30305716715156894],
          [0.40442318347016104, 0.9956596889514355],
          [0.3181048370985853, 0.9941056156262624],
          [0.4476555425412643, 0.10450858908993399],
          [0.005755711873678182, 0.08210314006393715],
          [0.6894436646305857, 0.024683789892439023],
          [0.37853847015039355, 0.9205583991129962],
          [0.147153220557374, 0.6763364538317627],
          [0.27609489026113754, 0.9525015467608335],
          [0.6191438641279736, 0.9391920106605185],
          [0.7751292774923786, 0.38429741020348684],
          [0.7879450832135235, 0.07505210902556914],
          [0.2708793430800669, 0.9953660558651352],
          [0.8584810943814412, 0.09411337832517086],
          [0.8176909771407952, 0.805358651749847],
          [0.12869670966305935, 0.061736926938826375],
          [0.27632038738239073, 0.41248644930875833],
          [0.7831048238365588, 0.2971150694208977],
          [0.3263295702565965, 0.656198229861692],
          [0.7066619696879022, 0.6273947598086749],
          [0.20526517972659297, 0.07831782107742047],
        ];

        while (i < count * count) {
          let filterRandom = paintingData[i][0];
          let filterValueRandom = paintingData[i][1];

          // paintingData.push([filterRandom, filterValueRandom]);

          let div = document.createElement("div");
          div.id = "div_" + i;

          if ((y == 0) & (i == 0)) {
            y += 1;
          } else {
            if (y > count - 1) {
              top += divH;
              left = 0;
              y = 1;
            } else {
              left += divW;
              y += 1;
            }
          }

          let filter = filters[Math.floor(filterRandom * filters.length)];
          let filterValue = 0;

          if (filter == "invert") {
            filterValue = Math.floor(filterValueRandom * 100) + 100 + "%";
            filter = `${filter}(${filterValue})`;
          } else if (filter == "saturate") {
            filterValue = Math.floor(filterValueRandom * 50) + "%";
            filter = `${filter}(${filterValue})`;
          } else if (filter == "normal") {
            filter = "none";
          } else if (filter == "hue-rotate") {
            filterValue = Math.floor(filterValueRandom * 360) + "deg";
            filter = `${filter}(${filterValue})`;
          }

          div.style = `width: ${divW}px;
                       height: ${divH}px;
                       background-image: url(${url});
                       background-size: ${imW}px ${imH}px;
                       background-position: top ${-top}px left ${-left}px;
                       filter: ${filter}`;
          // div.innerHTML = `<p>${left}|${top}|${y}</p>`;
          elem.append(div);

          i += 1;
        }

        // console.log(paintingData);
      });
    </script>
  </body>
</html>
